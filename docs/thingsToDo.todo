- [ ] completely redesign the code to be C code with no global state.

